<link rel="import" href="../utilities/http.html">
<link rel="import" href="../../bower_components/polymer/polymer.html">



<script>
    const POST_LOGIN_REQUEST = 'POST_LOGIN_REQUEST';
    const POST_LOGIN_FAILURE = 'POST_LOGIN_FAILURE';
    const POST_LOGIN_SUCCESS = 'POST_LOGIN_SUCCESS';



    const postLoginRequest = () => ({
        type: POST_LOGIN_REQUEST,
        payload:{
            fetching: true,
        }
    });

    const postLoginFailure = (error) => ({
        type: POST_LOGIN_FAILURE,
        payload:{
            fetching: false,
            error
        }
    });

    const postLoginSuccess = (user) => ({
        type: POST_LOGIN_SUCCESS,
        payload:{
            fetching: false,
            user,
        }
    });





    const UserActions = Polymer.dedupingMixin(function(superClass){
        return class UserActions extends superClass {
            constructor() {
               super();
            }

            postLogin() {
                return async (dispatch) => {
                    dispatch(postLoginRequest());
                    try {
                        const login = await post('user/login', {
                            email: this.username,
                            password: this.password,
                        });
                        console.log(login);
                    }catch(err) {
                        console.log("ERR", err);
                    }
                    

                    window.setTimeout(() => {
                        dispatch(postLoginSuccess({}));
                    }, 1000);
                }
            }
        }
    });



    // graphql(`
    //     query {
    //         user(id: 1) {
    //             name
    //         }
    //     }
    // `)
    // .then(res => res.data)
    // .then(console.log)
    // .catch(console.log);

    
    // console.log(axios.post);

</script>